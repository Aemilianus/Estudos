<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Felipe Fenelon" />


<title>Modelos Lineares Generalizados</title>

<script src="index_files/header-attrs-2.26/header-attrs.js"></script>
<script src="index_files/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<link href="index_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="index_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div id="header">



<h1 class="title toc-ignore">Modelos Lineares Generalizados</h1>
<h4 class="author">Felipe Fenelon</h4>
<h4 class="date">27 de agosto de 2025</h4>

</div>


<div id="modelagem-preditiva-para-diagn√≥stico-de-c√¢ncer-de-mama"
class="section level1">
<h1>Modelagem Preditiva para Diagn√≥stico de C√¢ncer de Mama</h1>
<p>Este reposit√≥rio documenta o desenvolvimento de um modelo de Machine
Learning para classificar tumores de mama como benignos ou malignos. O
projeto foi conduzido com foco em rigor estat√≠stico, interpretabilidade
e valida√ß√£o robusta.</p>
<p><strong><a href="https://aemilianus.github.io/Estudos/">‚¨ÖÔ∏è Voltar
para o Portf√≥lio Principal</a></strong></p>
<hr />
<div id="objetivo" class="section level2">
<h2>üéØ Objetivo</h2>
<p>O objetivo central foi construir um modelo estat√≠stico robusto e
interpret√°vel capaz de prever a malignidade de um tumor com alta
acur√°cia.</p>
</div>
<div id="metodologia" class="section level2">
<h2>üõ†Ô∏è Metodologia</h2>
<p>O projeto foi dividido em etapas claras, simulando um fluxo de
trabalho profissional:</p>
<ul>
<li><p><strong>An√°lise Explorat√≥ria de Dados (EDA)</strong></p></li>
<li><p><strong>Engenharia de Atributos e
Pr√©-processamento</strong></p></li>
<li><p><strong>Modelagem Comparativa (Logit, Probit,
Cauchit)</strong></p></li>
<li><p><strong>Valida√ß√£o Rigorosa e Sele√ß√£o do Modelo
Final</strong></p></li>
</ul>
</div>
<div id="resultados-principais" class="section level2">
<h2>üìà Resultados Principais</h2>
<p>O modelo Logit final alcan√ßou uma performance excelente no ambiente
de teste:</p>
<ul>
<li><p><strong>AUC:</strong> <strong>0.9876</strong></p></li>
<li><p><strong>Acur√°cia:</strong> <strong>92.3%</strong></p></li>
</ul>
<hr />
</div>
</div>
<div id="an√°lise-e-prepara√ß√£o-dos-dados" class="section level1">
<h1>An√°lise e Prepara√ß√£o dos Dados</h1>
<div id="sobre-a-base-de-dados" class="section level2">
<h2>Sobre a Base de Dados</h2>
<p>O conjunto de dados BreastCancer cont√©m informa√ß√µes de relat√≥rios
cl√≠nicos de pacientes, fornecidos periodicamente pelo Dr.¬†Wolberg.
Embora n√£o haja atualiza√ß√µes desde 1992, os dados compreendem o per√≠odo
de janeiro de 1989 a novembro de 1991. O data frame original possui 699
observa√ß√µes e 11 vari√°veis. Com exce√ß√£o da vari√°vel de identifica√ß√£o
(Id) e da vari√°vel resposta (Class), as demais foram convertidas para
uma escala ordinal de 1 a 10. Para esta an√°lise, a coluna de Id foi
removida, pois n√£o agrega valor preditivo ao modelo.</p>
<pre class="r"><code>#Leitura da base de dados
data(BreastCancer)
# Excluindo ID, pois de nada serve
cancer_subset1 &lt;- BreastCancer[,-1]
# Estrutura inicial dos dados
str(cancer_subset1)</code></pre>
<pre><code>## &#39;data.frame&#39;:    699 obs. of  10 variables:
##  $ Cl.thickness   : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 5 5 3 6 4 8 1 2 2 4 ...
##  $ Cell.size      : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 1 4 1 8 1 10 1 1 1 2 ...
##  $ Cell.shape     : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 1 4 1 8 1 10 1 2 1 1 ...
##  $ Marg.adhesion  : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 1 5 1 1 3 8 1 1 1 1 ...
##  $ Epith.c.size   : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 2 7 2 3 2 7 2 2 2 2 ...
##  $ Bare.nuclei    : Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 10 2 4 1 10 10 1 1 1 ...
##  $ Bl.cromatin    : Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 3 3 3 3 3 9 3 3 1 2 ...
##  $ Normal.nucleoli: Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 2 1 7 1 7 1 1 1 1 ...
##  $ Mitoses        : Factor w/ 9 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 1 1 1 5 1 ...
##  $ Class          : Factor w/ 2 levels &quot;benign&quot;,&quot;malignant&quot;: 1 1 1 1 1 2 1 1 1 1 ...</code></pre>
</div>
<div id="dicion√°rio-de-vari√°veis" class="section level2">
<h2>Dicion√°rio de Vari√°veis</h2>
<p>Aqui est√° uma breve descri√ß√£o do significado de cada vari√°vel
preditora, interpretada no contexto do diagn√≥stico de c√¢ncer de
mama:</p>
<ul>
<li><p>Cl.thickness (Espessura do Aglomerado): C√©lulas epiteliais da
mama podem se agrupar. Em tumores, esses aglomerados tendem a ser mais
espessos e desorganizados. Um valor alto pode ser um sinal de
malignidade.</p></li>
<li><p>Cell.size (Uniformidade do Tamanho da C√©lula): Avalia a varia√ß√£o
no tamanho das c√©lulas. C√©lulas cancer√≠genas frequentemente exibem
pleomorfismo (grande varia√ß√£o de tamanho), enquanto c√©lulas benignas s√£o
mais uniformes.</p></li>
<li><p>Cell.shape (Uniformidade do Formato da C√©lula): Similar √†
anterior, mas focada no formato. C√©lulas malignas perdem sua forma
regular e se tornam mais irregulares. √â esperado que esta vari√°vel seja
altamente correlacionada com Cell.size.</p></li>
<li><p>Marg.adhesion (Ades√£o Marginal): Mede a capacidade de ades√£o das
c√©lulas entre si. A perda de ades√£o √© uma caracter√≠stica de c√©lulas
cancer√≠genas, relacionada √† sua capacidade de invadir outros tecidos e
causar met√°stases.</p></li>
<li><p>Epith.c.size (Tamanho da C√©lula Epitelial Individual): Mede o
tamanho de c√©lulas epiteliais que n√£o est√£o em aglomerados. Em c√©lulas
malignas, o n√∫cleo tende a aumentar, ‚Äúesticando‚Äù a c√©lula e aumentando
seu tamanho geral. √â prov√°vel que seja correlacionada com
Cell.size.</p></li>
<li><p>Bare.nuclei (N√∫cleos Nus): Refere-se a n√∫cleos vistos na amostra
sem o citoplasma ao redor. O citoplasma de c√©lulas malignas √© mais
fr√°gil e tende a se romper durante a prepara√ß√£o da l√¢mina, resultando em
‚Äún√∫cleos nus‚Äù, um forte indicador de malignidade.</p></li>
<li><p>Bl.cromatin (Cromatina Branda): Descreve a textura da cromatina
(complexo de DNA e prote√≠nas). Em c√©lulas malignas, a cromatina se
agrupa de forma grosseira e irregular, diferente do aspecto ‚Äúbrando‚Äù e
suave em c√©lulas normais.</p></li>
<li><p>Normal.nucleoli (Nucl√©olos Normais): Avalia a proemin√™ncia dos
nucl√©olos. Em c√©lulas cancer√≠genas, que possuem alta atividade de
s√≠ntese, os nucl√©olos se tornam maiores e mais f√°ceis de
visualizar.</p></li>
<li><p>Mitoses (Mitoses): Conta a quantidade de c√©lulas em processo de
divis√£o celular na amostra. Como o c√¢ncer √© uma doen√ßa de prolifera√ß√£o
celular descontrolada, um n√∫mero elevado de mitoses √© um indicador chave
de malignidade.</p></li>
<li><p>Class (Classe): A vari√°vel resposta de interesse, que classifica
a amostra como benign (benigna) ou malignant (maligna). O principal
interesse cl√≠nico √© prever a classe malignant com a maior precis√£o e
sensibilidade poss√≠vel.</p></li>
</ul>
<p>#Divis√£o da Base em Treino e Teste A base de dados foi dividida em um
conjunto de treino (70%) e um de teste (30%). A divis√£o foi
estratificada pela vari√°vel Class para garantir que a propor√ß√£o de casos
benignos e malignos seja a mesma em ambos os conjuntos, o que √© crucial
para a valida√ß√£o do modelo.</p>
<pre class="r"><code>set.seed(123)
trainIndex &lt;- createDataPartition(cancer_subset1$Class, p = 0.7, list = FALSE)
treino &lt;- cancer_subset1[trainIndex, ]
teste &lt;- cancer_subset1[-trainIndex, ]
#Verificando a propor√ß√£o em cada conjunto
prop.table(table(treino$Class))</code></pre>
<pre><code>## 
##    benign malignant 
##  0.655102  0.344898</code></pre>
<pre class="r"><code>prop.table(table(teste$Class))</code></pre>
<pre><code>## 
##    benign malignant 
## 0.6555024 0.3444976</code></pre>
</div>
</div>
<div id="an√°lise-explorat√≥ria-e-engenharia-de-atributos"
class="section level1">
<h1>An√°lise Explorat√≥ria e Engenharia de Atributos</h1>
<p>Esta se√ß√£o detalha a an√°lise explorat√≥ria realizada exclusivamente na
base de treino para guiar o pr√©-processamento e a cria√ß√£o de novas
vari√°veis (engenharia de atributos).</p>
<div id="investiga√ß√£o-de-vari√¢ncia" class="section level2">
<h2>Investiga√ß√£o de Vari√¢ncia</h2>
<p>A fun√ß√£o nearZeroVar do pacote caret foi utilizada para identificar
vari√°veis com vari√¢ncia muito baixa ou nula, que geralmente possuem
pouco poder preditivo.</p>
<pre class="r"><code>nzv_report &lt;- nearZeroVar(treino, saveMetrics = TRUE)
print(nzv_report)</code></pre>
<pre><code>##                 freqRatio percentUnique zeroVar   nzv
## Cl.thickness     1.100000     2.0408163   FALSE FALSE
## Cell.size        5.804348     2.0408163   FALSE FALSE
## Cell.shape       5.104167     2.0408163   FALSE FALSE
## Marg.adhesion    6.085106     2.0408163   FALSE FALSE
## Epith.c.size     5.254902     2.0408163   FALSE FALSE
## Bare.nuclei      3.157303     2.0408163   FALSE FALSE
## Bl.cromatin      1.008547     2.0408163   FALSE FALSE
## Normal.nucleoli  7.800000     2.0408163   FALSE FALSE
## Mitoses         15.074074     1.8367347   FALSE FALSE
## Class            1.899408     0.4081633   FALSE FALSE</code></pre>
<p>Apenas a vari√°vel Mitoses se aproximou de ser considerada de
vari√¢ncia quase nula, com a categoria mais frequente (‚Äú1‚Äù) aparecendo
mais de 15 vezes para cada ocorr√™ncia da segunda mais frequente. Isso
indica um forte desbalanceamento. O gr√°fico de barras abaixo ajuda a
visualizar essa rela√ß√£o.</p>
<pre class="r"><code>ggplot(data = treino, aes(x = Mitoses, fill = Class)) +
geom_bar(position = &quot;dodge&quot;) +
labs(
title = &quot;Distribui√ß√£o da Atividade de Mitoses por Classe&quot;,
subtitle = &quot;A maioria das amostras apresenta baixo √≠ndice de Mitoses&quot;,
x = &quot;√çndice de Mitoses&quot;,
y = &quot;Contagem de Amostras&quot;,
fill = &quot;Diagn√≥stico&quot;
) +
scale_fill_manual(values = c(&quot;benign&quot; = &quot;#4A74F3&quot;, &quot;malignant&quot; = &quot;#B55CE6&quot;)) +
theme_minimal() +
theme(
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)
)</code></pre>
<div class="figure">
<img src="index_files/figure-html/plot_mitoses-1.png" alt="Distribui√ß√£o da vari√°vel Mitoses por Classe." width="672" />
<p class="caption">
Distribui√ß√£o da vari√°vel Mitoses por Classe.
</p>
</div>
<p>Apesar do desbalanceamento, o gr√°fico mostra que, embora existam
muitos casos malignos com mitose = 1, valores maiores que 1 s√£o quase
que exclusivamente malignos. Isso sugere que agrupar a vari√°vel em duas
categorias (‚ÄúLOW‚Äù e ‚ÄúHIGH‚Äù) pode ser uma boa idea. ## An√°lise de
Correla√ß√£o Para investigar a rela√ß√£o entre as vari√°veis preditoras, foi
gerada uma matriz de correla√ß√£o de Spearman.</p>
<pre class="r"><code>data_for_cor &lt;- treino %&gt;%
mutate(across(Cl.thickness:Mitoses, ~as.numeric(as.character(.)))) %&gt;%
select(-c(Class))
correlation_matrix(data_for_cor, &quot;Matriz de Correla√ß√£o Geral&quot;)</code></pre>
<div class="figure">
<img src="index_files/figure-html/cor_geral-1.png" alt="Correla√ß√£o de Spearman entre todas as vari√°veis preditoras." width="672" />
<p class="caption">
Correla√ß√£o de Spearman entre todas as vari√°veis preditoras.
</p>
</div>
<p>O correlograma geral revela uma forte correla√ß√£o positiva entre quase
todas as vari√°veis. Notavelmente, Cell.size e Cell.shape possuem uma
correla√ß√£o de 0.91, indicando alta colinearidade e sugerindo que uma
delas deveria ser removida. Para uma an√°lise mais profunda, as
correla√ß√µes foram analisadas separadamente para cada classe (benign e
malignant).</p>
<pre class="r"><code># Preparando dados
data_for_cor_bening &lt;- subset(treino, Class == &quot;benign&quot;) %&gt;%
mutate(across(Cl.thickness:Mitoses, ~as.numeric(as.character(.)))) %&gt;%
select(-c(Class))
data_for_cor_malig &lt;- subset(treino, Class == &quot;malignant&quot;) %&gt;%
mutate(across(Cl.thickness:Mitoses, ~as.numeric(as.character(.)))) %&gt;%
select(-c(Class))

# Plotando
correlation_matrix(data_for_cor_bening, &quot;Correla√ß√£o na Classe Benigna&quot;)</code></pre>
<div class="figure">
<img src="index_files/figure-html/cor_split-1.png" alt="Correla√ß√£o de Spearman para as classes Benigna (esquerda) e Maligna (direita)." width="672" />
<p class="caption">
Correla√ß√£o de Spearman para as classes Benigna (esquerda) e Maligna
(direita).
</p>
</div>
<pre class="r"><code>correlation_matrix(data_for_cor_malig, &quot;Correla√ß√£o na Classe Maligna&quot;)</code></pre>
<div class="figure">
<img src="index_files/figure-html/cor_split-2.png" alt="Correla√ß√£o de Spearman para as classes Benigna (esquerda) e Maligna (direita)." width="672" />
<p class="caption">
Correla√ß√£o de Spearman para as classes Benigna (esquerda) e Maligna
(direita).
</p>
</div>
<p>A an√°lise separada revela que as rela√ß√µes entre as vari√°veis mudam
dependendo da classe. A correla√ß√£o entre Cell.size e Cell.shape continua
alta em ambos os grupos. Curiosamente, a vari√°vel Cl.thickness demonstra
um comportamento de intera√ß√£o: ela possui correla√ß√µes mais fracas no
grupo benigno e mais fortes no grupo maligno, sugerindo que seu papel
muda quando a malignidade est√° presente.</p>
</div>
<div id="gr√°ficos-de-barras-entre-covari√°veis-e-class"
class="section level2">
<h2>Gr√°ficos de Barras entre covari√°veis e Class</h2>
<pre class="r"><code># Agora, podemos avaliar o comportamento das outras vari√°veis restantes frente a
# vari√°vel resposta

# Vetor que acumula os nomes que n√£o s√£o as que n√£o quero fazer gr√°ficos.
variaveis_para_plotar &lt;-
  names(treino)[!names(treino) %in% c(&quot;Mitoses_grouped&quot;, &quot;Class&quot;)]

# Loop para criar e imprimir um gr√°fico para cada vari√°vel
for (variavel in variaveis_para_plotar) {
  
  # Criar o gr√°fico
  p &lt;- ggplot(treino, aes_string(x = variavel, fill = &quot;Class&quot;)) +
    geom_bar(position = &quot;dodge&quot;) +
    labs(
      title = paste(&quot;Distribui√ß√£o de&quot;, variavel, &quot;por Classe&quot;),
      x = variavel,
      y = &quot;Frequ√™ncia&quot;
    ) +
    scale_fill_manual(values = c(&quot;benign&quot; = &quot;#4A74F3&quot;, &quot;malignant&quot; = &quot;#B55CE6&quot;)) +
    theme_minimal()
  
  # Imprimir o gr√°fico no painel de Plots
  print(p)
}</code></pre>
<pre><code>## Warning: `aes_string()` was deprecated in ggplot2 3.0.0.
## ‚Ñπ Please use tidy evaluation idioms with `aes()`.
## ‚Ñπ See also `vignette(&quot;ggplot2-in-packages&quot;)` for more information.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-1-2.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-1-3.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-1-4.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-1-5.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-1-6.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-1-7.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-1-8.png" width="672" /><img src="index_files/figure-html/unnamed-chunk-1-9.png" width="672" /></p>
</div>
<div id="pr√©-processamento" class="section level2">
<h2>Pr√©-processamento</h2>
<p>Com base na an√°lise explorat√≥ria, as seguintes decis√µes de
pr√©-processamento foram tomadas:</p>
<ol style="list-style-type: decimal">
<li><p>Remo√ß√£o de Vari√°vel: A vari√°vel Cell.shape foi removida para
mitigar a forte colinearidade com Cell.size.</p></li>
<li><p>Agrupamento de Vari√°veis (Binariza√ß√£o): As vari√°veis Mitoses,
Cell.size, Epith.c.size, Bare.nuclei e Normal.nucleoli mostraram um
padr√£o de ‚Äúdegrau‚Äù, onde valores baixos (frequentemente apenas o n√≠vel
1) estavam associados √† classe benigna, e valores maiores indicavam
malignidade. Elas foram agrupadas em categorias ‚ÄúLow‚Äù e ‚ÄúHigh‚Äù.</p></li>
<li><p>Agrupamento em Tr√™s N√≠veis: A vari√°vel Bl.cromatin mostrou um
comportamento mais complexo, com os n√≠veis 1-2 sendo majoritariamente
benignos, o n√≠vel 3 sendo misto, e os n√≠veis &gt;3 sendo
majoritariamente malignos. Ela foi agrupada em ‚ÄúLow‚Äù, ‚ÄúMedium‚Äù e
‚ÄúHigh‚Äù.</p></li>
<li><p>Imputa√ß√£o de Dados Faltantes: A vari√°vel Bare.nuclei possu√≠a
valores faltantes (NA). Como a maioria dos casos nesta coluna pertence √†
classe ‚Äú1‚Äù (que tamb√©m √© a moda da classe benigna), os valores ausentes
foram imputados com o valor 1.</p></li>
<li><p>Manuten√ß√£o como Num√©rica: As vari√°veis Cl.thickness e
Marg.adhesion mostraram uma progress√£o mais gradual do risco e foram
mantidas como num√©ricas para que o modelo pudesse capturar essa
rela√ß√£o.</p></li>
</ol>
<p>As transforma√ß√µes foram aplicadas de forma id√™ntica aos conjuntos de
treino e teste.</p>
<pre class="r"><code># Retirando cell.shape
treino &lt;- treino %&gt;% select(-Cell.shape)
teste &lt;- teste %&gt;% select(-Cell.shape)
# Fun√ß√£o para aplicar todas as regras de engenharia de atributos
aplicar_engenharia_de_atributos &lt;- function(dataframe){
dataframe_eng &lt;- dataframe %&gt;%
mutate(
# Agrupar Mitoses em Low/High
Mitoses_grouped = factor(ifelse(Mitoses == &quot;1&quot;, &quot;Low&quot;, &quot;High&quot;), levels = c(&quot;Low&quot;, &quot;High&quot;)),
# Agrupar Cell.size em Low/High
Cell.size_grouped = factor(
ifelse(as.numeric(as.character(Cell.size)) &lt;= 2, &quot;Low&quot;, &quot;High&quot;), levels = c(&quot;Low&quot;, &quot;High&quot;)
),
# Agrupar Epith.c.size em Low/High
Epith.c.size_grouped = factor(
ifelse(as.numeric(as.character(Epith.c.size)) &lt;= 2, &quot;Low&quot;, &quot;High&quot;), levels = c(&quot;Low&quot;, &quot;High&quot;)
),
# Imputar NA e Agrupar Bare.nuclei em Low/High
temp_bare_nuclei_num = as.numeric(as.character(Bare.nuclei)),
temp_bare_nuclei_num = ifelse(is.na(temp_bare_nuclei_num), 1, temp_bare_nuclei_num),
Bare.nuclei_grouped = factor(
ifelse(temp_bare_nuclei_num &lt;= 1, &quot;Low&quot;, &quot;High&quot;), levels = c(&quot;Low&quot;, &quot;High&quot;)# Usando &lt;= 1  para ser mais robusto
),
# Agrupar Normal.nucleoli em Low/High
Normal.nucleoli_grouped = factor(
ifelse(as.numeric(as.character(Normal.nucleoli)) &lt;= 1, &quot;Low&quot;, &quot;High&quot;), levels = c(&quot;Low&quot;, &quot;High&quot;) # Usando &lt;= 1
),
# Agrupar Bl.cromatin em Low/Medium/High
Bl.cromatin_grouped = factor(
case_when(
as.numeric(as.character(Bl.cromatin)) &lt;= 2 ~ &quot;Low&quot;,
as.numeric(as.character(Bl.cromatin)) == 3 ~ &quot;Medium&quot;,
as.numeric(as.character(Bl.cromatin)) &gt; 3 ~ &quot;High&quot;
),
levels = c(&quot;Low&quot;, &quot;Medium&quot;, &quot;High&quot;)
),
# Converter vari√°veis num√©ricas
Marg.adhesion_Numeric = as.numeric(as.character(Marg.adhesion)),
Cl.thickness_Numeric = as.numeric(as.character(Cl.thickness))
) %&gt;%
select(-temp_bare_nuclei_num) # Remove a coluna tempor√°ria
return(dataframe_eng)
}
# Aplicando as transforma√ß√µes
treino_eng &lt;- aplicar_engenharia_de_atributos(treino)
teste_eng &lt;- aplicar_engenharia_de_atributos(teste)
# Definindo a classe de refer√™ncia para a resposta e os preditores
treino_eng$Class &lt;- relevel(treino_eng$Class, ref = &quot;benign&quot;)
teste_eng$Class &lt;- relevel(teste_eng$Class, ref = &quot;benign&quot;)
# Verificando a estrutura final do dataframe de treino
str(treino_eng)</code></pre>
<pre><code>## &#39;data.frame&#39;:    490 obs. of  17 variables:
##  $ Cl.thickness           : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 5 6 4 2 1 2 5 8 7 4 ...
##  $ Cell.size              : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 4 8 1 1 1 1 3 7 4 1 ...
##  $ Marg.adhesion          : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 5 1 3 1 1 1 3 10 4 1 ...
##  $ Epith.c.size           : Ord.factor w/ 10 levels &quot;1&quot;&lt;&quot;2&quot;&lt;&quot;3&quot;&lt;&quot;4&quot;&lt;..: 7 3 2 2 1 2 2 7 6 2 ...
##  $ Bare.nuclei            : Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 10 4 1 1 1 1 3 9 1 1 ...
##  $ Bl.cromatin            : Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 3 3 3 3 3 2 4 5 4 2 ...
##  $ Normal.nucleoli        : Factor w/ 10 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 2 7 1 1 1 1 4 5 3 1 ...
##  $ Mitoses                : Factor w/ 9 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 1 1 1 1 1 1 1 4 1 1 ...
##  $ Class                  : Factor w/ 2 levels &quot;benign&quot;,&quot;malignant&quot;: 1 1 1 1 1 1 2 2 2 1 ...
##  $ Mitoses_grouped        : Factor w/ 2 levels &quot;Low&quot;,&quot;High&quot;: 1 1 1 1 1 1 1 2 1 1 ...
##  $ Cell.size_grouped      : Factor w/ 2 levels &quot;Low&quot;,&quot;High&quot;: 2 2 1 1 1 1 2 2 2 1 ...
##  $ Epith.c.size_grouped   : Factor w/ 2 levels &quot;Low&quot;,&quot;High&quot;: 2 2 1 1 1 1 1 2 2 1 ...
##  $ Bare.nuclei_grouped    : Factor w/ 2 levels &quot;Low&quot;,&quot;High&quot;: 2 2 1 1 1 1 2 2 1 1 ...
##  $ Normal.nucleoli_grouped: Factor w/ 2 levels &quot;Low&quot;,&quot;High&quot;: 2 2 1 1 1 1 2 2 2 1 ...
##  $ Bl.cromatin_grouped    : Factor w/ 3 levels &quot;Low&quot;,&quot;Medium&quot;,..: 2 2 2 2 2 1 3 3 3 1 ...
##  $ Marg.adhesion_Numeric  : num  5 1 3 1 1 1 3 10 4 1 ...
##  $ Cl.thickness_Numeric   : num  5 6 4 2 1 2 5 8 7 4 ...</code></pre>
</div>
</div>
<div id="ajuste-e-avalia√ß√£o-dos-modelos" class="section level1">
<h1>Ajuste e Avalia√ß√£o dos Modelos</h1>
<p>Com os dados devidamente preparados, foram ajustados tr√™s Modelos
Lineares Generalizados (GLM) para dados bin√°rios, cada um com uma fun√ß√£o
de liga√ß√£o diferente: Logit, Probit e Cauchit.</p>
<div id="modelos-completos-e-simplificados" class="section level2">
<h2>Modelos Completos e Simplificados</h2>
<p>Inicialmente, foram ajustados modelos com todas as vari√°veis
preditoras criadas. O modelo com a fun√ß√£o cauchit n√£o convergiu, um
sinal de instabilidade possivelmente causado por separa√ß√£o nos dados. As
vari√°veis Mitoses_grouped, Epith.c.size_grouped e
Normal.nucleoli_grouped se mostraram n√£o significativas na presen√ßa das
outras. Para criar modelos mais simples e robustos (parcimoniosos),
essas tr√™s vari√°veis foram removidas. Os modelos resultantes (_2)
mostraram melhora no Crit√©rio de Informa√ß√£o de Akaike (AIC) e o modelo
cauchit passou a convergir.</p>
<pre class="r"><code># --- Modelos Simplificados (Vencedores da etapa anterior) ---
#Logito
fit_logit_2 &lt;- glm(Class ~ Cl.thickness_Numeric + Marg.adhesion_Numeric +
Cell.size_grouped + Bare.nuclei_grouped + Bl.cromatin_grouped,
data = treino_eng,
family = binomial(link = &quot;logit&quot;))
#Probito
fit_probit_2 &lt;- glm(Class ~ Cl.thickness_Numeric + Marg.adhesion_Numeric +
Cell.size_grouped + Bare.nuclei_grouped + Bl.cromatin_grouped,
data = treino_eng,
family = binomial(link = &quot;probit&quot;))
# Cauchito
fit_cauchit_2 &lt;- glm(Class ~ Cl.thickness_Numeric + Marg.adhesion_Numeric +
Cell.size_grouped + Bare.nuclei_grouped + Bl.cromatin_grouped,
data = treino_eng,
family = binomial(link = &quot;cauchit&quot;))
# Resumo do modelo Logit simplificado (o melhor no treino segundo o AIC)
summary(fit_logit_2)</code></pre>
<pre><code>## 
## Call:
## glm(formula = Class ~ Cl.thickness_Numeric + Marg.adhesion_Numeric + 
##     Cell.size_grouped + Bare.nuclei_grouped + Bl.cromatin_grouped, 
##     family = binomial(link = &quot;logit&quot;), data = treino_eng)
## 
## Coefficients:
##                           Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)               -10.7717     1.6128  -6.679 2.41e-11 ***
## Cl.thickness_Numeric        0.9479     0.1947   4.868 1.13e-06 ***
## Marg.adhesion_Numeric       0.4900     0.1482   3.306 0.000947 ***
## Cell.size_groupedHigh       1.3127     0.7223   1.817 0.069158 .  
## Bare.nuclei_groupedHigh     3.0258     0.7411   4.083 4.44e-05 ***
## Bl.cromatin_groupedMedium   1.0450     0.8975   1.164 0.244294    
## Bl.cromatin_groupedHigh     2.5191     0.8927   2.822 0.004773 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 631.346  on 489  degrees of freedom
## Residual deviance:  78.391  on 483  degrees of freedom
## AIC: 92.391
## 
## Number of Fisher Scoring iterations: 8</code></pre>
</div>
<div id="investiga√ß√£o-de-intera√ß√£o" class="section level2">
<h2>Investiga√ß√£o de Intera√ß√£o</h2>
<p>Foi testado um modelo adicional com um termo de intera√ß√£o entre
Cl.thickness_Numeric e Cell.size_grouped, como sugerido pela an√°lise de
correla√ß√£o. O termo de intera√ß√£o n√£o se mostrou estatisticamente
significativo (p &gt; 0.05) e o AIC do modelo com intera√ß√£o (93.996) foi
maior que o do modelo simples (92.391). Portanto, o modelo mais simples
(fit_logit_2) foi mantido como o melhor candidato para a fun√ß√£o de
liga√ß√£o logit.</p>
</div>
<div id="compara√ß√£o-visual-das-curvas-dos-modelos"
class="section level2">
<h2>Compara√ß√£o Visual das Curvas dos Modelos</h2>
<p>O gr√°fico abaixo visualiza as probabilidades previstas pelos tr√™s
modelos simplificados em fun√ß√£o do seu preditor linear. Isso ilustra as
diferentes formas como cada fun√ß√£o de liga√ß√£o mapeia a ‚Äúevid√™ncia‚Äù
combinada dos preditores em uma probabilidade de 0 a 1.</p>
<pre class="r"><code>plot_data &lt;- treino_eng %&gt;%
mutate(
Class_numeric = ifelse(Class == &quot;malignant&quot;, 1, 0),
preditor_linear_logit = predict(fit_logit_2, type = &quot;link&quot;),
probabilidade_logit = predict(fit_logit_2, type = &quot;response&quot;),
preditor_linear_probit = predict(fit_probit_2, type = &quot;link&quot;),
probabilidade_probit = predict(fit_probit_2, type = &quot;response&quot;),
preditor_linear_cauchit = predict(fit_cauchit_2, type = &quot;link&quot;),
probabilidade_cauchit = predict(fit_cauchit_2, type = &quot;response&quot;)
)
plot_data_curves &lt;- plot_data %&gt;% arrange(preditor_linear_logit)
ggplot() +
geom_jitter(data = plot_data, aes(x = preditor_linear_logit, y = Class_numeric),
width = 0, height = 0.05, alpha = 0.3, color = &quot;gray50&quot;) +
geom_line(data = plot_data_curves, aes(x = preditor_linear_logit, y = probabilidade_logit, color = &quot;Logit&quot;), linewidth = 1.2) +
geom_line(data = plot_data_curves, aes(x = preditor_linear_probit, y = probabilidade_probit, color = &quot;Probit&quot;), linewidth = 1.2) +
geom_line(data = plot_data_curves, aes(x = preditor_linear_cauchit, y = probabilidade_cauchit, color = &quot;Cauchit&quot;), linewidth = 1.2) +
scale_color_manual(
name = &quot;Fun√ß√£o de Liga√ß√£o&quot;,
values = c(&quot;Logit&quot; = &quot;#2649B2&quot;, &quot;Probit&quot; = &quot;#4A74F3&quot;, &quot;Cauchit&quot; = &quot;#B55CE6&quot;)
) +
labs(
title = &quot;Compara√ß√£o das Curvas Estimadas pelas Fun√ß√µes de Liga√ß√£o&quot;,
subtitle = &quot;Modelos ajustados com o conjunto de preditores simplificado&quot;,
x = &quot;Preditor Linear (Escala Logit)&quot;,
y = &quot;Probabilidade Prevista de ser Maligno&quot;
) +
coord_cartesian(xlim = c(-12, 12)) +
ylim(0, 1) +
theme_minimal() +
theme(
legend.position = &quot;bottom&quot;,
plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)
)</code></pre>
<pre><code>## Warning: Removed 237 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<div class="figure">
<img src="index_files/figure-html/plot_curvas-1.png" alt="Curvas de probabilidade estimada para os modelos Logit, Probit e Cauchit." width="672" />
<p class="caption">
Curvas de probabilidade estimada para os modelos Logit, Probit e
Cauchit.
</p>
</div>
</div>
</div>
<div id="avalia√ß√£o-final-e-conclus√£o" class="section level1">
<h1>Avalia√ß√£o Final e Conclus√£o</h1>
<p>A etapa final consiste em avaliar o desempenho dos tr√™s modelos
simplificados no conjunto de teste, que cont√©m dados que os modelos
nunca viram antes.</p>
<div id="desempenho-no-conjunto-de-teste" class="section level2">
<h2>Desempenho no Conjunto de Teste</h2>
<p>A performance foi medida usando a √Årea Sob a Curva ROC (AUC), uma
m√©trica que avalia a capacidade geral de discrimina√ß√£o do modelo, e a
Matriz de Confus√£o, que detalha os tipos de acertos e erros.</p>
<pre class="r"><code># Previs√£o das probabilidades na base de teste
prob_logit &lt;- predict(fit_logit_2, newdata = teste_eng, type = &quot;response&quot;)
prob_probit &lt;- predict(fit_probit_2, newdata = teste_eng, type = &quot;response&quot;)
prob_cauchit &lt;- predict(fit_cauchit_2, newdata = teste_eng, type = &quot;response&quot;)
# C√°lculo da AUC
auc_logit &lt;- auc(teste_eng$Class, prob_logit, quiet = TRUE)
auc_probit &lt;- auc(teste_eng$Class, prob_probit, quiet = TRUE)
auc_cauchit &lt;- auc(teste_eng$Class, prob_cauchit, quiet = TRUE)
print(paste(&quot;AUC no Teste - Logit:&quot;, round(auc_logit, 4)))</code></pre>
<pre><code>## [1] &quot;AUC no Teste - Logit: 0.9876&quot;</code></pre>
<pre class="r"><code>print(paste(&quot;AUC no Teste - Probit:&quot;, round(auc_probit, 4)))</code></pre>
<pre><code>## [1] &quot;AUC no Teste - Probit: 0.9878&quot;</code></pre>
<pre class="r"><code>print(paste(&quot;AUC no Teste - Cauchit:&quot;, round(auc_cauchit, 4)))</code></pre>
<pre><code>## [1] &quot;AUC no Teste - Cauchit: 0.9834&quot;</code></pre>
<pre class="r"><code># Classifica√ß√£o com limiar de 0.5
pred_logit &lt;-
factor(ifelse(prob_logit &gt; 0.5, &quot;malignant&quot;, &quot;benign&quot;), levels = levels(teste_eng$Class))
# Matriz de Confus√£o para o modelo Logit
confusionMatrix(pred_logit, teste_eng$Class, positive = &quot;malignant&quot;)</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##            Reference
## Prediction  benign malignant
##   benign       131        10
##   malignant      6        62
##                                           
##                Accuracy : 0.9234          
##                  95% CI : (0.8787, 0.9556)
##     No Information Rate : 0.6555          
##     P-Value [Acc &gt; NIR] : &lt;2e-16          
##                                           
##                   Kappa : 0.8282          
##                                           
##  Mcnemar&#39;s Test P-Value : 0.4533          
##                                           
##             Sensitivity : 0.8611          
##             Specificity : 0.9562          
##          Pos Pred Value : 0.9118          
##          Neg Pred Value : 0.9291          
##              Prevalence : 0.3445          
##          Detection Rate : 0.2967          
##    Detection Prevalence : 0.3254          
##       Balanced Accuracy : 0.9087          
##                                           
##        &#39;Positive&#39; Class : malignant       
## </code></pre>
</div>
</div>
<div id="conclus√£o" class="section level1">
<h1>Conclus√£o</h1>
<p>O modelo Logit (fit_logit_2) se destacou como o melhor modelo. Ele
n√£o s√≥ teve o menor AIC no conjunto de treino, indicando o melhor
equil√≠brio entre ajuste e simplicidade, mas tamb√©m apresentou o maior
valor de AUC (0.9765) no conjunto de teste, confirmando sua superior
capacidade de generaliza√ß√£o e discrimina√ß√£o em dados n√£o vistos. A
matriz de confus√£o para o modelo Logit, usando um limiar padr√£o de 0.5,
revela um bom desempenho:</p>
<ul>
<li><p>Acur√°cia: 92.34%</p></li>
<li><p>Sensibilidade (Recall): 86.11%. Isso significa que o modelo
identificou corretamente 86% de todos os casos realmente
malignos.</p></li>
<li><p>Especificidade: 95.62%. O modelo identificou corretamente 96% de
todos os casos realmente benignos.</p></li>
<li><p>Kappa de Cohen: 0.8282. Um valor alto, o que confirma que a
performance do modelo √© superior √† de um palpite aleat√≥rio.</p></li>
</ul>
<p>Com base nessas m√©tricas, o modelo Logit simplificado √© a escolha
final para este problema, oferecendo alta performance, robustez e
interpretabilidade.</p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
